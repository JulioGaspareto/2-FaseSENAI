CREATE DATABASE correios ;
use correios;

-- no DATE para popular é invertido exp 2025-09-24

CREATE TABLE cliente(
id_cliente INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(45),
cidade VARCHAR(45)
);

CREATE TABLE acompanhamento(
id_acompanhamento INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
situacao VARCHAR(45)
);


CREATE TABLE pedido(
id_pedido INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
data_pedido DATE,
valor DECIMAL(8,2),
cliente_id INT ,
FOREIGN KEY(cliente_id) REFERENCES cliente(id_cliente),
acompanhamento_id INT,
FOREIGN KEY(acompanhamento_id) REFERENCES acompanhamento(id_acompanhamento)
);

INSERT INTO cliente
(nome,cidade)
value
("João","Macaé"),
("Carlos","Salvador"),
("Maria","Niteroí"),
("Ana","Campinas"),
("Marcos","Santos");


INSERT INTO acompanhamento
(situacao)
value
("Registrado"),
("Em transporte"),
("Entregue");

INSERT INTO pedido
(data_pedido,valor,cliente_id,acompanhamento_id)
value
('2024-09-24',250.00,2,1),
('2024-09-25',150.00,1,2),
('2024-09-25',450.00,4,3);

select*from pedido 
JOIN cliente  -- com isso nos vamos juntar as duas tabelas
ON pedido.cliente_id = cliente.id_cliente  -- e aqui vai ser tipo uma filtragem onde colocamos que a chava estrangeira é a msm do que a primaria 
JOIN acompanhamento
ON pedido.acompanhamento_id = acompanhamento.id_acompanhamento;

-- para filtrar oq as coisas que foram pedidas, assim voce seleciona oq vai aparecer na tabla
select pedido.id_pedido,pedido.data_pedido,cliente.nome,acompanhamento.situacao from pedido 
JOIN cliente  
ON pedido.cliente_id = cliente.id_cliente -- como aqui ja foi dito de onde estamos tirando, nao vai precisar dos pontos "pedido.cliente_id"
JOIN acompanhamento
ON acompanhamento_id = id_acompanhamento;  -- exemplo se ponto 



-- criando a view vamos colocar o atalha dentro dela para facilitar e nao criar toda hora esse codigo 
CREATE VIEW vw_consulta_cliente_pedido_situacao AS
select pedido.id_pedido,pedido.data_pedido,cliente.nome,acompanhamento.situacao from pedido 
JOIN cliente  
ON pedido.cliente_id = cliente.id_cliente 
JOIN acompanhamento
ON acompanhamento_id = id_acompanhamento ;

-- chamar a VIEW
SELECT * FROM vw_consulta_cliente_pedido_situacao;

-- INNER JOIN OU JOIN  é a msm coisa 


